{"version":3,"file":"index.es.js","sources":["../src/listenable.ts"],"sourcesContent":["export type ListenerOptions = {\n\tonce?: boolean\n\t// @TODO: abortable\n}\n\nexport const listenable = <CallbackData = unknown>() => {\n\ttype Callback = (data: CallbackData) => void\n\ttype Listener = {\n\t\tcallback: Callback\n\t\toptions: ListenerOptions\n\t}\n\n\tconst listeners: Listener[] = []\n\n\tconst findIndex = (callback: Callback) =>\n\t\tlisteners.findIndex((listener) => listener.callback === callback)\n\n\tconst addListener = (callback: Callback, options: ListenerOptions = {}) => {\n\t\t// Prevent duplicate listeners\n\t\tif (findIndex(callback) >= 0) {\n\t\t\treturn\n\t\t}\n\n\t\tlisteners.push({ callback, options })\n\t}\n\n\tconst removeListener = (callback: Callback) => {\n\t\tconst listenerIndex = findIndex(callback)\n\t\tif (listenerIndex >= 0) {\n\t\t\tlisteners.splice(listenerIndex, 1)\n\t\t}\n\t}\n\n\tconst emit = (data: CallbackData) => {\n\t\tlisteners.forEach((listener) => {\n\t\t\tlistener.callback(data)\n\t\t\tif (listener.options.once) {\n\t\t\t\tremoveListener(listener.callback)\n\t\t\t}\n\t\t})\n\t}\n\n\treturn {\n\t\taddListener,\n\t\tremoveListener,\n\t\temit,\n\t}\n}\n"],"names":[],"mappings":"AAKa,IAAA,UAAU,GAAG,YAAA;IAOzB,IAAM,SAAS,GAAe,EAAE,CAAA;IAEhC,IAAM,SAAS,GAAG,UAAC,QAAkB,EAAA;AACpC,QAAA,OAAA,SAAS,CAAC,SAAS,CAAC,UAAC,QAAQ,EAAA,EAAK,OAAA,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAA,EAAA,CAAC,CAAA;AAAjE,KAAiE,CAAA;AAElE,IAAA,IAAM,WAAW,GAAG,UAAC,QAAkB,EAAE,OAA6B,EAAA;AAA7B,QAAA,IAAA,OAAA,KAAA,KAAA,CAAA,EAAA,EAAA,OAA6B,GAAA,EAAA,CAAA,EAAA;;AAErE,QAAA,IAAI,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YAC7B,OAAM;AACN,SAAA;QAED,SAAS,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAA,QAAA,EAAE,OAAO,EAAA,OAAA,EAAE,CAAC,CAAA;AACtC,KAAC,CAAA;IAED,IAAM,cAAc,GAAG,UAAC,QAAkB,EAAA;AACzC,QAAA,IAAM,aAAa,GAAG,SAAS,CAAC,QAAQ,CAAC,CAAA;QACzC,IAAI,aAAa,IAAI,CAAC,EAAE;AACvB,YAAA,SAAS,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC,CAAA;AAClC,SAAA;AACF,KAAC,CAAA;IAED,IAAM,IAAI,GAAG,UAAC,IAAkB,EAAA;AAC/B,QAAA,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ,EAAA;AAC1B,YAAA,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;AACvB,YAAA,IAAI,QAAQ,CAAC,OAAO,CAAC,IAAI,EAAE;AAC1B,gBAAA,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;AACjC,aAAA;AACF,SAAC,CAAC,CAAA;AACH,KAAC,CAAA;IAED,OAAO;AACN,QAAA,WAAW,EAAA,WAAA;AACX,QAAA,cAAc,EAAA,cAAA;AACd,QAAA,IAAI,EAAA,IAAA;KACJ,CAAA;AACF;;;;"}